
# Plan 11: Global Search (⌘K)

This plan implements a global search and command palette to allow users to quickly find tasks, modules, notes, and navigate the application via a ⌘K shortcut.

## Proposed Changes

### [Backend] Global Search Router

#### [NEW] [search.py](file:///Users/oli/Desktop/CraftCanvas/backend/routers/search.py)
- Create a `GET /search` endpoint that accepts a `q` query parameter.
- Fetch results from:
    - **Tasks**: [select(Task).where(Task.title.contains(q))](file:///Users/oli/Desktop/CraftCanvas/frontend/app/assignments/page.tsx#151-160)
    - **Courses**: [select(Course).where(Course.code.contains(q) | Course.name.contains(q))](file:///Users/oli/Desktop/CraftCanvas/frontend/app/assignments/page.tsx#151-160)
    - **Notes**: [select(Note).where(Note.title.contains(q))](file:///Users/oli/Desktop/CraftCanvas/frontend/app/assignments/page.tsx#151-160)
- Return a grouped response: `{ tasks: [], courses: [], notes: [], navigation: [] }`.

#### [MODIFY] [main.py](file:///Users/oli/Desktop/CraftCanvas/backend/main.py)
- Register the search router.

### [Frontend] Global Command Palette

#### [NEW] [CommandPalette.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/components/CommandPalette.tsx)
- Create a floating command palette component using `dialog` or a customized modal.
- Bind `⌘K` (and `Ctrl+K`) to toggle visibility.
- Search input with real-time fetching from `/api/v1/search`.
- Sectioned results (Tasks, Courses, Notes, Navigation).
- Keyboard navigation (Arrow keys + Enter).

#### [MODIFY] [layout.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/app/layout.tsx)
- Embed the `CommandPalette` globally.

## Verification Plan

### Automated Tests
- Test `/search` endpoint with various queries.
- Verify ⌘K event listener in a test environment.

### Manual Verification
- Press ⌘K from any page.
- Search for a specific module code (e.g., "CS2103").
- Select a search result and verify it navigates to the correct page.

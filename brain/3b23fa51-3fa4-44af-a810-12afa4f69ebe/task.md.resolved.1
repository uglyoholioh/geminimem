- [x] Phase 1: Planning (Completed)
- [/] Phase 2: Frontend Dependencies & Boilerplate
    - [ ] Update frontend `package.json` with `react-markdown`.
    - [ ] Create [BriefChat](file:///Users/oli/Desktop/CraftCanvas/backend/routers/brief.py#26-29) model in `backend/models/chat.py`.
    - [ ] Update [backend/database.py](file:///Users/oli/Desktop/CraftCanvas/backend/database.py) with [BriefChat](file:///Users/oli/Desktop/CraftCanvas/backend/routers/brief.py#26-29).
- [/] Phase 3: Streaming & Chat Persistence
    - [ ] Add `GET /chat/history` and `POST /chat/stream` in [backend/routers/brief.py](file:///Users/oli/Desktop/CraftCanvas/backend/routers/brief.py).
    - [ ] Update [frontend/app/page.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/app/page.tsx) to handle SSE streaming for chat.
    - [ ] Update Frontend to parse Markdown (`react-markdown`).
    - [ ] Load chat history on frontend mount.
- [ ] Phase 4: Enhance Action Types & Suggestions
    - [ ] Update [backend/routers/brief.py](file:///Users/oli/Desktop/CraftCanvas/backend/routers/brief.py) AI instructions with new actions.
    - [ ] Update [frontend/components/chat/ActionCard.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/components/chat/ActionCard.tsx) with mark_done, set_reminder, etc.
    - [ ] Implement Dynamic Suggestions in [/chat](file:///Users/oli/Desktop/CraftCanvas/frontend/components/chat) panel based on state in [page.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/app/page.tsx).
    - [ ] Connect "Ask AI" deep link to assignment items.
- [ ] Phase 5: Smarter Brief Generator
    - [ ] Update [brief_generator.py](file:///Users/oli/Desktop/CraftCanvas/backend/services/brief_generator.py) to calculate busyness and gaps for study sessions.
    - [ ] Implement `lookahead_days` in [_get_due_soon](file:///Users/oli/Desktop/CraftCanvas/backend/services/brief_generator.py#60-89) and [_get_today_classes](file:///Users/oli/Desktop/CraftCanvas/backend/services/brief_generator.py#32-58) / new functions.
    - [ ] Instruct LLM to output inline `:::action` in `prose_text` directly.
    - [ ] Add Lookahead selector component in [page.tsx](file:///Users/oli/Desktop/CraftCanvas/frontend/app/page.tsx) connected to brief regeneration.
    - [ ] Parse inline `:::action` in `prose_text` in frontend.
- [ ] Phase 6: Scheduler & RAG Pipeline
    - [ ] Create `backend/services/scheduler.py` for 7 AM SGT CRON task.
    - [ ] Hook scheduler into [backend/main.py](file:///Users/oli/Desktop/CraftCanvas/backend/main.py) lifespan events.
    - [ ] Create `backend/services/rag_service.py` to handle chunking + ChromaDB embedding.
    - [ ] Update `backend/routers/brief_chat` to query `rag_service` for exact info instead of full PDF truncate limit.
- [ ] Phase 7: Verification
    - [ ] Run backend tests.
    - [ ] Open localhost browser, test functionality manually.

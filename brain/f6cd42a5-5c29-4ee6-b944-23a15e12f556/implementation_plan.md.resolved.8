# Phase 12: Activity & Meeting Finder

We are building a when2meet-style meeting and activity availability finder, inspired by the LMSManager project. This tool will allow users to create shareable meeting pages where participants (even unauthenticated ones) can paint their availability on a grid, and the application will compute and overlay the heatmaps.

## User Review Required

> [!WARNING]
> Since participants can be anyone with the link, we will need to create public-facing GET and POST endpoints that bypass the standard JWT/Cookie auth dependency and rely purely on the embedded `share_token`. Are you happy to proceed with this shareable model?

## Proposed Changes

### Database Models

#### [NEW] `backend/models/meeting.py`
Create the core schema for meetings and participants:
```python
class Meeting(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    user_id: int = Field(foreign_key="users.id") # The creator
    title: str
    share_token: str = Field(unique=True, index=True) # e.g. a secure random uuid string
    date_range_start: date
    date_range_end: date
    time_range_start: int # e.g. 9 for 09:00
    time_range_end: int # e.g. 17 for 17:00

class MeetingParticipant(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    meeting_id: int = Field(foreign_key="meetings.id")
    name: str # The participant's display name
    availability: str # JSON stringified array of slots [{"dayOfWeek": 1, "startHour": 9, "endHour": 17, "isAvailable": true}]
```

### Backend API

#### [NEW] `backend/routers/meetings.py`
Create the routing layer:
- `POST /api/v1/meetings/`: Require auth, create a new Meeting for the user.
- `GET /api/v1/meetings/`: Require auth, list user's meetings.
- `GET /api/v1/meetings/shared/{token}`: Public access, fetch meeting details and all participants by token.
- `POST /api/v1/meetings/shared/{token}/participants`: Public access, create or update a participant's availability.

### Frontend Application

#### [NEW] `frontend/app/meetings/page.tsx`
An authenticated hub page replicating the aesthetic of `/tasks` and `/assignments`, where the user can view the meetings they've created and generate new meeting links via a modal.

#### [NEW] `frontend/app/meetings/[token]/page.tsx`
A public-facing route completely bypassing the `<AuthProvider>` lock.
- Will display the Meeting Title.
- **Login Panel**: Ask the user for their name (or detect if they are logged in and prefill).
- **Availability Grid**: A complex interactive heatmap. Users click and drag over hour blocks to toggle their personal availability.
- **Group Overlay**: The grid acts as a composite heatmap showing fractional availability across all participants (e.g., 3/4 available renders as light green, 4/4 renders as dark green).

#### [NEW] `frontend/components/meetings/AvailabilityGrid.tsx`
A highly interactive React component utilizing pointer events to support drag-to-paint across an X (Days) / Y (Hours) CSS grid.

## Verification Plan

### Automated/Subagent Verification
- Database schema migration applies successfully without dropping unrelated tables.
- Browser subagent creates a Meeting as an authenticated user.
- Subagent navigates privately to the `/[token]` route.
- Subagent inputs a mock name and submits availability payload.
- Verify heatmap renders correctly with the newly posted availability JSON.
